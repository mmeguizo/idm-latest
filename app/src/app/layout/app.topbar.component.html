<div class="layout-topbar">
    <a class="layout-topbar-logo" routerLink="/">
        <img
            src="assets/layout/images/{{
                layoutService.config().colorScheme === 'light' ? 'logo' : 'logo'
            }}.png"
            alt="logo"
        />
        <span class="text-xl">Institutional Dashboard Monitoring</span>
    </a>

    <button
        #menubutton
        class="p-link layout-topbar-button"
        (click)="layoutService.onMenuToggle()"
    >
        <i class="pi pi-bars"></i>
    </button>

    <button
        #topbarmenubutton
        class="p-link layout-topbar-menu-button layout-topbar-button"
        (click)="layoutService.showProfileSidebar()"
    >
        <i class="pi pi-ellipsis-v"></i>
    </button>

    <div
        #topbarmenu
        class="layout-topbar-menu"
        [ngClass]="{
            'layout-topbar-menu-mobile-active':
                layoutService.state.profileSidebarVisible
        }"
    >
        <!-- <button class="p-link layout-topbar-button">
            <i class="pi pi-calendar"></i>
            <span>Calendar</span>
        </button> -->

        <!-- <p-splitButton
            icon="pi pi-cog"
            [model]="Listitems"
            styleClass="p-button-secondary"
        ></p-splitButton> -->

        <p-menubar #avatarMenu [model]="Listitems">
            <ng-template pTemplate="end"> </ng-template>
        </p-menubar>
        <p-toast></p-toast>
        <button class="p-link layout-topbar-button">
            <img
                [(src)]="this.dangerousUrl"
                alt="Image"
                class="rounded-full"
                height="40"
                (click)="avatarMenu.toggle($event)"
            />
            <!-- <i class="pi pi-user"></i> -->
            <span>Profile</span>
        </button>

        <!-- <button
            class="p-link layout-topbar-button"
            [routerLink]="'/documentation'"
        >
            <i class="pi pi-cog"></i>
            <span>Settings</span>
        </button> -->
    </div>

    <!-- <p-tieredMenu #avatarMenu [model]="Listitems" [popup]="true"></p-tieredMenu> -->
    <p-dialog
        header="Edit Profile"
        [(visible)]="visible"
        [style]="{ width: '25rem' }"
        position="top"
    >
        <!-- <span class="p-text-secondary block mb-5"
            >Update your information.</span
        >  -->

        <form [formGroup]="form">
            <div class="flex align-items-center gap-3 mb-3">
                <label for="username" class="font-semibold w-6rem"
                    >Username</label
                >
                <input
                    pInputText
                    id="username"
                    class="flex-auto"
                    autocomplete="off"
                    [ngClass]="
                        form?.get('username').touched &&
                        form.controls['username'].errors?.required
                            ? 'ng-invalid'
                            : ''
                    "
                    formControlName="username"
                />
            </div>
            <div class="flex align-items-center gap-3 mb-5">
                <label for="email" class="font-semibold w-6rem">Email</label>
                <input
                    pInputText
                    id="email"
                    class="flex-auto"
                    [ngClass]="
                        form?.get('email').touched &&
                        form.controls['email'].errors?.required
                            ? 'ng-invalid'
                            : ''
                    "
                    formControlName="email"
                    autocomplete="off"
                />
            </div>
            <div class="flex align-items-center gap-3 mb-5">
                <label for="password1" class="font-semibold w-6rem"
                    >Old Password</label
                >
                <p-password
                    id="password1"
                    [ngClass]="
                        form?.get('old_password').touched &&
                        form.controls['old_password'].errors?.required
                            ? 'ng-invalid'
                            : ''
                    "
                    [toggleMask]="true"
                    class="flex-auto"
                    formControlName="old_password"
                ></p-password>
            </div>
            <div class="flex align-items-center gap-3 mb-5">
                <label for="password1" class="font-semibold w-6rem"
                    >New Password</label
                >
                <p-password
                    id="password1"
                    [toggleMask]="true"
                    class="flex-auto"
                    formControlName="password"
                    [ngClass]="{ passwordNotMatch: 'ng-invalid' }"
                ></p-password>
            </div>
            <div class="flex align-items-center gap-3 mb-5">
                <label for="password1" class="font-semibold w-6rem"
                    >Confirm Password</label
                >
                <p-password
                    id="password1"
                    [toggleMask]="true"
                    class="flex-auto"
                    [ngClass]="{ passwordNotMatch: 'ng-invalid' }"
                    formControlName="confirmPassword"
                ></p-password>
            </div>
            <div class="flex align-items-center gap-3 mb-5">
                @if (profile_pic) {
                <div
                    class="display-photo"
                    [style.background-image]="
                        'url(' +
                        this.auth.domain +
                        '/images/' +
                        (profile_pic || 'no-photo.png') +
                        ')'
                    "
                    (click)="openFile($event, 'file')"
                ></div>
                }
                <input type="file" name="file" class="d-none" id="file" />
            </div>
            <div class="flex gap-2 footer-button">
                <p-button
                    label="Cancel"
                    severity="secondary"
                    (click)="visible = false"
                />
                <p-button label="Save" (click)="updates(form)" />
            </div>
        </form>
    </p-dialog>
</div>

<p-dialog
    header="Logout?"
    [(visible)]="logout"
    position="top"
    [modal]="true"
    showEffect="fade"
    [style]="{ width: '20vw' }"
    [breakpoints]="{ '960px': '50vw' }"
>
    <p class="line-height-3 m-0">Are you sure you want to logout?</p>
    <ng-template pTemplate="footer">
        <button
            pButton
            icon="pi pi-check"
            (click)="kickout()"
            label="Ok"
            class="p-button-outlined"
        ></button>
    </ng-template>
</p-dialog>
<!-- <p-confirmPopup style="top: 6%; left: 43%" key="confirm2"></p-confirmPopup> -->
